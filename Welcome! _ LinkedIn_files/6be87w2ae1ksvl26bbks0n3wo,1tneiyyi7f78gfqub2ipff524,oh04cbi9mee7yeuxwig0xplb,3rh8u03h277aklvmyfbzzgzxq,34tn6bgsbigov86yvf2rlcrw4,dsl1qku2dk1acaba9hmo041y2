(function(){function v(){n.find("[role\x3dmenuitem]").removeClass("selected deselected")}function C(){var b=c.bind(D,this);e("body").on("click",function l(a){b(a,l)})}function D(b,a){e(b.target).closest("#share-box").length||(g.val()||!w.is(".hidden"))||(e("body").off("click",a),this.collapseShareBox())}function E(b){b=n.find("[role\x3dmenuitem]");a.attr("data-"+x,a.data(y));g.data("li-auto-click-utrki",a.attr("data-share-box-utrki"));r.triggerClickTracking(g.data("li-auto-click-utrki"),g);b.filter(".selected").length||
(b.first().addClass("selected"),b.slice(1).addClass("deselected"));this.expandShareBox()}function F(){m.removeClass(z+" presentation-expanded");this.changeSubmitButtonState(f)}function s(){this.changeSubmitButtonState(f)}function G(){this.changeSubmitButtonState(f)}function H(){m.addClass(z);this.changeSubmitButtonState(p)}function I(){this.collapseShareBox()}function J(b){b=k.data("selected-option");switch(b){case "CONNECTIONS":dataAttr="share-conn-utrk-el";break;case "TWITTER":dataAttr="share-twitter-utrk-el";
break;default:dataAttr="share-everyone-utrk-el"}h.attr("data-li-utrk-el",a.attr("data-"+dataAttr));K(A,b)}function L(){var b=this._mentions.getInstance(g),b=b&&b.generateMentions(),b='{"numMentions":'+(b&&b.length||0)+"}";h.closest("[data-li-utrk-el]").attr("data-li-utrk-custom",b)}function M(){this.changeSubmitButtonState(f).removeClass("submitting")}function N(){var b=this;c.delay(function(){b.changeSubmitButtonState(f).removeClass("submitting")},200)}function O(){this.changeSubmitButtonState(p).addClass("submitting")}
function P(b){b=e(b.target);b.is(".share, .upload")&&(v(),b.parent().addClass("selected").siblings().addClass("deselected"),b.is(".share")?this.expandShareBox():c.delay(c.bind(this.expandShareBox,this),20))}function Q(){a=e("#share-box");a.length&&(clearTimeout(B),n=a.find("#share-actions"),h=a.find(".postmodule-submit"),g=a.find(R),k=e(S),m=a.find(T),e(U),w=e("#article-preview-container"),new t)}var e=LIModules.requires("jquery"),c=LIModules.requires("underscore"),r=LIModules.requires("UserActivityTrackingInstance"),
V=LIModules.requires("Events"),W=LIModules.requires("Mentions"),X=LIModules.requires("PostModule"),Y=LIModules.requires("TextCountPlugin"),Z=LIModules.requires("MentionsValidityPlugin"),$=LIModules.requires("TextUpdateManager"),aa=LIModules.requires("readCookie"),K=LIModules.requires("createCookie"),ba=LIModules.requires("UrlPreviewPlugin"),ca=LIModules.requires("ExpandingTextEntry"),da=LIModules.requires("Placeholder"),ea=LIModules.requires("sharebox.configFactory"),fa=LIModules.requires("sharebox.configTypes"),
u,q,R=".postmodule-text",U="#slideshare-file-input",T="#slideshare-upload-form",S="#share-with-combo-select",z="is-active",A="share_setting",p="disabled",f="enabled",a,n,h,g,k,m,w,B,x="li-utrk-el",y="opened-utrk-el",t=function(){this.init()};t.prototype={init:function(){var b,d,l,f=aa(A)||"PUBLIC";ea(fa.OZ);u=LIModules.imports("TwitterTethering");q=LIModules.imports("RichMediaUploaderPlugin");b=e("#ozfeed").data("isb-entitlement")?"/hp/influencer-entitlement":"/nhome/influencer-entitlement";this._mentions=
new W.Delegator(a.get(0),{mentionsTL:"common-templates/mentions-play",entitlementUrl:b});this.postModule=new X(a);if(u){if(d=a.data("twitterHandle"))l=" ("+d+")",b=k.find("#share-with-twitter"),b.attr({"data-twitter-providerId":a.data("twitterProviderid"),"data-twitter-handle":d}).removeAttr("data-twitter-tether-url").removeAttr("data-twitter-tether-url-via-nsettings").text(b.text().replace(l,"")+l);this.twitterTether=new u(k)}this.textCountPlugin=new Y({rootSelector:"#share-box",textAreaSelector:"#postmodule-text"});
this.mentionsValidityPlugin=new Z({rootSelector:"#share-box"});k.on("change",J);"PRIVATE"===f||!d&&"TWITTER"===f||k.val(f).change();this.urlPreviewPlugin=new ba({transformJson:this.transformJson,preview:{targetEl:"#article-preview-container",eventType:"article-preview"},poller:{pollingTimeout:5E3}});this.urlPreviewPlugin.previewModule.on("previewDismissed",c.bind(F,this)).on("previewRendered",c.bind(s,this));this.ete=new ca(g);this.placeholder=new da(a,{});m.length?this.richMediaPlugin=new q({preview:{targetEl:"#article-preview-container",
previewTemplate:"sharebox-static/templates/article-preview/share-image-preview"},fileInputId:"slideshare-file-input",memberId:a.data("member-info").id,$slideshareUploaderForm:m}):q=null;d={rootSelector:"#share-box",textAreaSelector:"#postmodule-text",textCountPlugin:this.textCountPlugin,urlPreviewPlugin:this.urlPreviewPlugin,preview:{targetEl:"#article-preview-container",previewTemplate:"sharebox-static/templates/article-preview/share-image-preview"}};this.richMediaPlugin&&(d.richMediaPlugin=this.richMediaPlugin);
this.textUpdateManager=new $(d);this.postModule.addPlugin(this.textCountPlugin);this.postModule.addPlugin(this.mentionsValidityPlugin);this.postModule.addPlugin(this.urlPreviewPlugin);this.postModule.addPlugin(this.textUpdateManager);q&&this.postModule.addPlugin(this.richMediaPlugin);e(document).on("previewLoading",c.bind(H,this)).on("previewLoaded",c.bind(s,this)).on("previewError",c.bind(s,this));n.on("click",c.bind(P,this));g.on("focus",c.bind(E,this));h.on("mousedown",c.bind(L,this));a.on("validationChange",
c.bind(G,this));V.on("postmodule.reset",c.bind(I,this)).on("postmodule.submitting",c.bind(O,this)).on("postmodule.submit",c.bind(N,this)).on("postmodule.submit-fail",c.bind(M,this))},collapseShareBox:function(){a.is(".opened")&&(this.constructJsonObject(),v(),this.textCountPlugin.reset(),this.richMediaPlugin&&this.richMediaPlugin.errorMessageModule&&this.richMediaPlugin.errorMessageModule.removeErrorMessage(),a.removeClass("opened"),g.val("").removeAttr("style").change(),c.delay(function(){a.addClass("closed")},
10),this.impresssionFire(),a.attr("data-"+x,a.data("closed-utrk-el")),r.fireImpressionEvents())},constructJsonObject:function(){var b=a.data("member-info");return{memberImage:{photo:b.photo,name:b.name},showPencilIcon:a.data("enable-pencilicon"),enableTwitter:a.data("display-rich-media-twitter"),memberId:b.id,twitterHandle:a.data("twitter-handle"),twitterProviderId:a.data("twitter-providerid"),twitterTetheringUrl:a.data("twitter-tether-url"),twitterTetheringUrlViaNSettings:a.data("twitter-tether-url-via-nsettings"),
trk:{elementTrk:a.data("closed-utrk-el"),elementTrkExpanded:a.data(y),elementTrkCollapsed:a.data("closed-utrk-el"),shareButtonTrk:a.data("share-utrki"),shareElementTrk:a.data("share-everyone-utrk-el")},clickTrks:{paperClip:a.data("paper-clip-utrki"),ponchoPencil:a.data("pencil-utrki"),shareBox:a.data("share-box-utrki")}}},expandShareBox:function(){if(a.is(".closed")){var b=this.constructJsonObject();b.elementTrk=b.elementTrkExpanded;a.removeClass("closed");this.impresssionFire();r.fireImpressionEvents();
c.delay(function(){a.addClass("opened");g.focus()},300);C.call(this)}},changeSubmitButtonState:function(b){var a=0<arguments.length?b:f,c=this.mentionsValidityPlugin.getIsValid()&&this.textCountPlugin.getIsValid();a===f&&c?h.prop(p,!1):h.prop(p,!0);return h},impresssionFire:function(){a.removeAttr("data-li-utrk-impr_fired");a.attr("data-li-utrk-impr","")},transformJson:function(a){var d,e;d=a.content[0];a={blocks:[{template:"articles/side-article",blocks:[{template:"entities/carousel-block",blocks:[]},
{template:"content-description/side-description",blocks:[{template:"content-description/side-info-share-box",title:d.title||"",description:d.description,author:"",source:d.sourceDomain,url:d.resolvedUrl,contentType:d.contentType}]}]}]};e=a.blocks[0].blocks[0].blocks;d.previewImages?c.each(d.previewImages,function(a){e.push({template:"images/side-content-image",image:a.mediaProxyUrl,title:d.title,description:d.description})}):e.push({template:"images/side-content-stock-image",title:d.title,description:d.description});
return a}};e(function(){B=setInterval(Q,50)});LIModules.exports("HPPostModule",t)})();(function(){var e=LIModules.requires("jquery"),f=LIModules.requires("underscore");LIModules.requires("i18n");var m=LIModules.requires("HopscotchCallout"),g=LIModules.imports("PlayLego"),d=function(d){function n(a){new m(a,{id:"publishing-hopscotch",title:dust.i18n.cache[b].i18n_oz_publish_hopscotch_title,content:dust.i18n.cache[b].i18n_oz_publish_hopscotch_content,orientation:"bottom",openOnLoad:!0,ctaLabel:dust.i18n.cache[b].i18n_oz_publish_hopscotch_CTA,yOffset:0,width:220,arrowOffset:105,xOffset:-30,
ctaOnClick:function(){h(p,"oz-publish-hopscotch-shown");setTimeout(function(){window.location="/pulse/article/new?trk\x3doz-publish-hopscotch-trk"},300)},onShow:f.partial(g.fireImpressionEvent,[c]),onClose:f.partial(h,q,"oz-publish-hopscotch-dismissed")})}function h(a,b){g.fireActionEvent(c,a,b,1)}var q="DISMISS",p="PRIMARY_ACTION",b="share-templates/pulseHopscotch",a,k,c,l;return{init:function(){a=e("#share-box");k=a.find(".publish.spot");(c=(l=a.data("memberInfo"))&&l.legoToken)&&n(k[0])}}}(d);
e(function(){d.init()})})();(function(){var b=LIModules.requires("jquery"),c=LIModules.requires("underscore"),d=LIModules.requires("Events"),h=LIModules.requires("AuthenticateConnect"),f,e=function(a){f=LIModules.requires("OzHelpers");this.$el=a;this.authenticateConnect=new h({eventNamespace:".pymk",previousContentSelector:".current"});this._bindEvents()};e.prototype={handleAuthenticateToggle:function(a){this._setTabIndexTo(a)},handleAuthenticateSuccess:function(a){this.handleConnectSuccess(a)},handleConnectClicked:function(a){var b=
a.closest(".card"),d={name:a.data("first-name"),url:a.data("connect-url")};b.find(".authenticate-connect").length?this.authenticateConnect.show(a,d):f.ajax({url:d.url,type:"POST",success:c.bind(function(b){"success"===b.status?this.handleConnectSuccess(a):this.authenticateConnect.show(a,d)},this)})},handleConnectSuccess:function(a){var c=a.closest(".card");dust.render("pymk-templates/invitation-sent-toast",{},function(f,e){var g=b(e);c.append(g);setTimeout(function(){g.addClass("show")},20);setTimeout(function(){d.fire("next.pymk",
{url:a.data("fetch-url"),$row:a.parents(".row")})},900)})},handleSkipClicked:function(a){d.fire("next.pymk",{url:a.data("skip-url"),$row:a.parents(".row")})},handlePeekClicked:function(a){d.fire("next.pymk",{url:this.$el.find(".card.current").find("button.skip").data("skip-url"),$row:a.parents(".row")})},handleButtonMouseup:function(a){a.blur()},_bindEvents:function(){this.$el.on("click","button.connect",c.bind(function(a){this.handleConnectClicked(b(a.target))},this)).on("click","button.skip",c.bind(function(a){this.handleSkipClicked(b(a.target))},
this)).on("click","button.peek",c.bind(function(a){this.handlePeekClicked(b(a.target))},this)).on("mouseup","button",c.bind(function(a){this.handleButtonMouseup(b(a.target))},this));d.on("authenticate-connect-toggle.pymk",c.bind(this.handleAuthenticateToggle,this)).on("authenticate-connect-success.pymk",c.bind(this.handleAuthenticateSuccess,this))},_setTabIndexTo:function(a){this.$el.find(".card.current").find("button, a").attr("tabindex","-1");a.find("button, a").removeAttr("tabindex")}};LIModules.exports("PymkCard",
e)})();(function(){var e=LIModules.requires("jquery"),f=LIModules.requires("underscore"),k=LIModules.requires("Events"),g=LIModules.imports("TrackFailure"),n=LIModules.requires("PymkCard"),l,m,h=function(a){l=LIModules.requires("OzHelpers");m=LIModules.requires("UserActivityTrackingInstance");this.$el=a;this.pymkQueryOffset=a.data("query-offset");this.pymkRequestQueue=[];this.pymkPeopleRemain=!0;this.rowsDismissed=0;this.numRows=a.find(".row:not(.dismissed)").length;this.cardDustPath=a.data("connect-inline")?
"pymk-templates/pymk-card-connect-inline":"pymk-templates/pymk-card";this._setTabIndex();this._bindEvents();new n(a)};h.prototype={handleNext:function(a){var b=a.$row,c=b.find(".card.current"),b=b.find(".card:not(.current):not(.dismissed):first");c.addClass("dismissed").removeClass("current");b.length?(b.addClass("current"),b.attr("data-li-utrk-impr",""),m.fireImpressionEvents(),k.fire("update-impression.pymk")):this._tryDismiss();this._setTabIndex();this.pymkRequestQueuePush(a)},pymkRequestQueuePush:function(a){this.pymkRequestQueue.push(a);
1===this.pymkRequestQueue.length&&this.pymkRequestQueuePop()},pymkRequestQueuePop:function(){var a=this.pymkRequestQueue[0];a&&l.ajax({url:a.url+"\x26offset\x3d"+this.pymkQueryOffset,success:f.bind(function(b){this.pymkQueryOffset=b.nextQueryOffset;this.pymkPeopleToCards(b.people,a.$row);this.pymkRequestQueue.shift();this.pymkRequestQueuePop()},this),error:f.bind(function(a,c,d){g&&("timeout"===c?g.logError("pymkModuleTimeout","PYMK module AJAX request timed out."):"error"===c&&g.logError("pymkModuleException",
"PYMK module AJAX error. Status code: "+a.status+" "+a.statusText+". Error message: "+d+"."));this.pymkPeopleRemain=!1;this._tryDismiss()},this)})},pymkPeopleToCards:function(a,b){a.length?this.pymkPeopleRemain=!0:(this.pymkPeopleRemain=!1,this._tryDismiss());for(var c=0;c<a.length;c++)dust.render(this.cardDustPath,a[c],f.bind(function(a,c){this.addCard(c,b)},this))},addCard:function(a,b){var c=b.find(".card.current"),d=e(a);c.length?(d.addClass("hidden"),setTimeout(function(){d.removeClass("hidden")},
10)):d.addClass("current");b.append(d);this._setTabIndex()},_setTabIndex:function(){this.$el.find("a:not(.header), button").attr("tabindex","-1");this.$el.find(".card.current").find("a, button:not(.peek)").removeAttr("tabindex");this.$el.find(".row:not(.dismissed)").each(function(){e(this).find(".card:not(.current):not(.dismissed):first").find(".peek").removeAttr("tabindex")})},_tryDismiss:function(){var a=this;this.$el.find(".row:not(.dismissed)").each(function(){var b=e(this);b.find(".card:not(.dismissed):not(.dismissing)").length||
a.pymkPeopleRemain||(b.addClass("dismissed"),a.$el.addClass("dismissed-row"),a.rowsDismissed++,a.rowsDismissed>=a.numRows&&a.$el.addClass("dismissed"))})},_bindEvents:function(){k.on("next.pymk",f.bind(function(a){this.handleNext(a)},this))}};e(function(){new h(e("#pymk"))});LIModules.exports("Pymk",h)})();(function(){var k=LIModules.requires("jquery"),b=LIModules.requires("underscore"),e=LIModules.requires("BaseControl"),f=LIModules.requires("Events");LIModules.exports("StickyRail",e.extend(function(e){function s(a){a.removeClass(t);p=q=!1;a.addClass(r);g=!0}var t="absolute-sticky",r="fixed-sticky",u=1E3/60,l=k(window),c,m,p=!1,g=!1,q=!0,d=0,h=81;return{attachEventListeners:function(){var a=LIModules.imports("globalNav");m=this._$el;l.on("load",b.bind(this.togglePosition,this));l.resize(b.throttle(b.bind(this.togglePosition,
this),u));l.scroll(b.throttle(b.bind(this.togglePosition,this),u));f.on("infinitePagination-newPage",b.bind(this.togglePosition,this));"fixed"===k("#responsive-nav-scrollable").css("position")&&this.handleGlobalNavHide();a&&a.subNav?(a.subNav.onDidAnimateDown(b.bind(this.handleGlobalNavShow,this)),a.subNav.onDidAnimateUp(b.bind(this.handleGlobalNavHide,this))):(f.on("globalnav:showStart",b.bind(this.handleGlobalNavShow,this)),f.on("globalnav:hideStart",b.bind(this.handleGlobalNavHide,this)))},afterDecoration:function(){c=
c||k("#content");this.contentOffset=parseInt(c.offset().top,10)},togglePosition:function(){var a=m,b=l.scrollTop(),f=a.height(),e,n=Math.ceil(a.offset().top);c=c||k("#content");e=this.contentOffset+c.height();n+f>=e?g?(a.removeClass(r),g=!1,a.addClass(t),p=!0):p&&b+h<=n&&s(a):q&&b+h>=n?(d=n-h,s(a)):g&&b<=d&&(a.removeClass(r),g=!1,q=!0)},handleGlobalNavShow:function(){m.addClass("global-nav-showing");h=81;d-=29},handleGlobalNavHide:function(){m.removeClass("global-nav-showing");h=52;d+=29}}}))})();(function(){var a=LIModules.requires("jquery"),b=LIModules.requires("StickyRail");a(function(){new b(a("#sticky-rail"))})})();